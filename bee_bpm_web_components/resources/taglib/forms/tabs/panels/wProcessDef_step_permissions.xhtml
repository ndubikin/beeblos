<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:beecomp="http://www.beeblos.org/bee_bpm_web_components">



	<h:form id="w_process_def_step_permissions" style="margin-left: 16px;">

		<h:panelGrid width="100%" columns="1">

       		<rich:contextMenu attached="false" id="w_process_def_step_permissions_menu_response" submitMode="ajax">
            	<rich:menuItem ajaxSingle="true">
                	<b> Add responses </b>
                	<a4j:actionparam name="det" assignTo="#{wStepDefFormBean.currObjId}" value="{currentRowId}"/>
            	</rich:menuItem>
             	<rich:menuItem ajaxSingle="true">
                	<b> Delete responses </b>
                	<a4j:actionparam name="det" assignTo="#{wStepDefFormBean.currObjId}" value="{currentRowId}"/>
            	</rich:menuItem>
            </rich:contextMenu>
		</h:panelGrid>   


		<h:panelGrid width="100%" columns="1">

       		<rich:contextMenu attached="false" id="w_process_def_step_permissions_menu_related_users" submitMode="ajax">
            	<rich:menuItem ajaxSingle="false">
            	<b> Add related users </b>
                	<a4j:actionparam name="det" assignTo="#{wStepDefFormBean.currObjId}" value="{currentRowId}"/>
            	</rich:menuItem>
            	<rich:menuItem ajaxSingle="false">
            	<b> Delete related users </b>
                	<a4j:actionparam name="det" assignTo="#{wStepDefFormBean.currObjId}" value="{currentRowId}"/>
            	</rich:menuItem>
            </rich:contextMenu>
            
		</h:panelGrid>   

		<rich:dataTable id="w_process_def_step_response"
				value="#{wStepDefFormBean.responseList}"
				onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
				onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
				var="response" width="100%" columnClasses="center" rows="5"
				reRender=""  
				rendered="#{wStepDefFormBean.responseSize gt 0}">
				
				<f:facet name="header">
					<h:outputText value="#{msg.label_step_responses}" />
				</f:facet>

				<rich:column sortBy="#{response.name}"
					style="width:250px; text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.label_name}" />
					</f:facet>
					<h:outputText value="#{response.name}" />
				</rich:column>
				
				<rich:componentControl event="onRowClick" for="w_process_def_step_permissions_menu_response"
					operation="show">
               		<f:param value="#{response.id}" name="currentRowId"/>
				</rich:componentControl>				
				
		</rich:dataTable>

		<rich:spacer height="20px"/>

		<rich:dataTable id="w_process_def_related_users_table"
				value="#{wStepDefFormBean.roleRelatedList}"
				onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
				onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
				var="step_role" width="100%" columnClasses="center" rows="5"
				reRender=""  
				rendered="#{wStepDefFormBean.roleRelatedListSize gt 0}">

				<f:facet name="header">
					<h:outputText value="#{msg.label_roles_with_permissions_for_this_step}" />
				</f:facet>

				<rich:column sortBy="#{step_role.role.name}"
					style="width:250px; text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.label_role}" />
					</f:facet>
					<h:outputText value="#{step_role.role.name}" />
					<h:outputText value="  ( #{msg.label_admin} )" rendered="#{step_role.admin}"/>
				</rich:column>

				<rich:componentControl event="onRowClick" for="w_process_def_step_permissions_menu_related_users"
					operation="show">
               		<f:param value="#{step_role.id}" name="currentRowId"/>
				</rich:componentControl>

		</rich:dataTable>

		<rich:spacer height="20px"/>

		<h:outputText value="#{msg.label_users_with_permissions_for_this_step}" 
						style="font-weight:bold; "/>


		<h:outputText value="#{msg.label_no_step_selected}" 
					rendered="#{wStepDefFormBean.currObjId eq null or wStepDefFormBean.currObjId eq 0}"
					style="font-weight: bold;"/>


	</h:form>

</ui:composition>