<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">


	<style type="text/css">
.colStyle1 {
	width: 150px;
	margin: 0px;
}

.colStyle2 {
	width: 250px;
	margin: 0px;
}

.colStyle2B {
	width: 250px;
	margin: 0px;
}

.colStyle3 {
	width: 20px;
	margin: 0px;
}

.colStyle4 {
	width: 150px;
	margin: 0px;
	
}
.colStyle5 {
	width: 300px;
	margin: 0px;
}
.colStyle6{
	width: 50px;
	margin: 0px;
}
.viewFilters {
	text-align: center; padding-left: 0px; font-size: 11px; cursor: pointer; color: #7795AF; font-family: Verdana; text-decoration: underline
}

.controlsEditorPanel {
	border : 0px; padding: 0px; margin :  0px 0px 0px 0px; overflow: auto; width: 100%;
}
</style>

<script language="VBScript">
	//Set WshNetwork = CreateObject("WScript.Network")

	//alert(WshNetwork.UserName)
	//document.frmUceHeader.userName.value = WshNetwork.UserName
	//document.frmUceHeader.computerName.value = WshNetwork.ComputerName
	//document.frmUceHeader.userDomain.value = WshNetwork.UserDomain

	
</script>

<script type="text/javascript">
	
	//alert("renderizando...");

	//var urlForAction = null;
    
	function confirm() {		 
		
		var txtNombre = document.getElementById("w_user_email_account_form:name");
			
		if( txtNombre.value == "" ){
			return false;
		}	  	
	
	  	var txtConfirm = "Are you sure that you want delete this indicator"+String.fromCharCode(63);
		if (confirm(txtConfirm)) {			

			//alert(" urlForAction = " + urlForAction)
			/*
			A4J.AJAX.Submit('frmUceHeader',event,
							{'similarityGroupingId':'frmUceHeader:deleteButton',
							 'parameters':{'frmUceHeader:deleteButton':'frmUceHeader:deleteButton'}, 
							 'actionUrl':urlForAction} );
			*/
			return true;
		}
		return false;
	}


	
	function submitFrmUceLista(){ 
		document.getElementById("w_user_email_account_form:name").submit();
		
				
	} 
	

//-->
</script>


	<f:loadBundle basename="org.beeblos.bpm.wc.taglib.util.messages" var="msg" />

	<h:messages showDetail="true" showSummary="true"/>

	<rich:spacer></rich:spacer>

	<center><!-- ********************************* Gestion Cuentas de Email********************    -->

	<rich:panel style="width:100%"  >
		
			<rich:spacer height="10" />
		
		<h:form id="w_user_email_account_form">

		
<a4j:jsFunction name="onsubmitChangePasswordButton" action="#{wEmailAccountBean.changePassword}" reRender="output_password_panel" /> 
		
		
			<h:panelGrid id="exceptionsPnl"  rendered="#{exceptionBean.renderMessage}">
				<rich:dataTable value="#{exceptionBean.exceptionList}" var="exp" >
		            <rich:column> 
		                <f:facet name="header">	                    
		                </f:facet>	           
		                <h:graphicImage value="#{exp.imagePath}" />  	                     
		            </rich:column>
		            <rich:column> 
		                <f:facet name="header">
		                    <h:outputText value="#{msg.label_message}"/>
		                </f:facet>
		                <h:outputText value="#{exp.code} "/>
		                <h:outputText value="#{exp.message}"/>
		            </rich:column>	            
		            				
				</rich:dataTable>
			</h:panelGrid>

			<h:panelGrid columns="3" width="60%" >
											
				<h:outputText value="#{msg.label_name}" styleClass="labelForm" />
				<h:panelGroup>
					<h:inputHidden id="hddIdUce" value="#{wEmailAccountBean.id}">
						<a4j:support ajaxSingle="false"  action="#{wEmailAccountBean.loadCurrentWEmailAccount}"
							event="onchange" reRender="w_user_email_account_form, w_user_email_accounts_table, name, saveButton, deleteButton" />
					</h:inputHidden>
					<h:inputText id="name" value="#{wEmailAccountBean.currEmailAccount.name}"
						required="false"  style="width:250px"/>
				</h:panelGroup>
				
				<rich:spacer width="10" />
				
				<h:outputText value="#{msg.label_email}" styleClass="labelForm" />
				<h:panelGroup>
					<h:inputText id="email" value="#{wEmailAccountBean.currEmailAccount.email}"
						required="false"  style="width:250px"/>
				</h:panelGroup>
				<h:panelGroup>
				<rich:spacer width="10" />
	
				<a4j:commandButton id="saveButton" value="#{msg.label_save}" reRender="w_user_email_account_form"
					action="#{wEmailAccountBean.save}"/>			
						
				<rich:spacer width="10" />	
				<h:commandButton id="deleteButton" value="#{msg.label_delete}" 
					actionListener="#{wEmailAccountBean.delete}" onclick="return confirm()"/>						
										
				</h:panelGroup>	
				
		<rich:spacer width="10" />
		<rich:spacer width="10" />	
				
		<h:panelGroup>
		
			<a4j:outputPanel styleClass="viewFilters" id="look">
				<rich:effect for="look" event="onclick" type="Fade" params="delay:0.0, duration:0.1" disableDefault="true"/>
				<rich:effect for="look" event="onclick" type="BlindDown" targetId="filtros" params="delay:0.1,duration:0.5,from:0.0,to:1.0"/>
				<rich:effect for="look" event="onclick" type="Appear"  targetId="filtros"  params="delay:0.1,duration:0.5,from:0.0,to:1.0" />
				<rich:effect for="look" event="onclick" type="Appear"  targetId="hide2"  params="delay:0.1,duration:0.5,from:0.0,to:1.0" />
				<h:outputText escape="false" value="#{msg.label_mostrarConfiguracion}" />
			</a4j:outputPanel>

			<a4j:outputPanel id="hide2" styleClass="viewFilters" style="display:none">
				<rich:effect for="hide2" event="onclick" type="BlindUp" targetId="filtros" params="id:'filtros', duration:0.5" />
				<rich:effect for="hide2" event="onclick" type="Appear" targetId="look" params="delay:0.2, duration:0.5" />
				<rich:effect for="hide2" event="onclick" type="Fade" targetId="hide2" params="delay:0.0, duration:0.2" />
				<h:outputText style="padding-right:5px" value="#{msg.label_ocultarConfiguracion}"/>
			</a4j:outputPanel>
		 </h:panelGroup>
		 
		</h:panelGrid>

		<h:panelGrid id="filtros" columns="1" style="width:100%; display:none;" >
			<h:panelGrid id="generales" columns="3" columnClasses="colStyle1,colStyle2B,colStyle3" >
				
				<h:outputText value="#{msg.label_user_default_account}" styleClass="labelForm" />
				<h:selectBooleanCheckbox id="isPrefer" value="#{wEmailAccountBean.currEmailAccount.userDefaultAccount}"
					required="false"  style="text-align:left"/>	
				<rich:spacer height="10" />
				
				<h:outputText value="#{msg.label_reply_to}" styleClass="labelForm" />
				<h:inputText id="reply_to" value="#{wEmailAccountBean.currEmailAccount.replyTo}"
					required="false"  style=" width:250px"/>	
				<rich:spacer height="10" />
				
				<h:outputText id="txt_signature" value="#{msg.label_signature_txt}" styleClass="labelForm"/>
				<h:inputTextarea id="txt_signature_text" value="#{wEmailAccountBean.currEmailAccount.signatureTxt}"
					required="false" style="width:600px; height:150px;"/>			
				<rich:spacer id="spcFirmaTexto" height="10"/>
				
				<h:outputText id="html_signature" value="#{msg.label_firma_html}" styleClass="labelForm"/>
	            <h:panelGroup id="signature_html_control">
					<rich:editor id="html_signature_text" configuration="#{editorBean.currentConfiguration}" 
								 width="600" height="150" viewMode="#{editorBean.viewMode}" 
								 value="#{wEmailAccountBean.currEmailAccount.signatureHtml}" >
					</rich:editor>

	                <h:panelGrid columns="1">
	                    <h:selectOneRadio value="#{editorBean.viewMode}">
	                        <f:selectItem itemLabel="displaying HTML" itemValue="visual" />
	                        <f:selectItem itemLabel="HTML text" itemValue="source" />
	                        <a4j:support event="onclick" reRender="html_signature_text, signature_html_control" requestDelay="500"
	                            eventsQueue="settingsQueue" similarityGroupingId="settings" />
	                    </h:selectOneRadio>
	                </h:panelGrid>
				</h:panelGroup>
				<rich:spacer id="spcFirmaHtml" height="10"/>
				
			</h:panelGrid>
			
			<fieldset id="input" class="demo_fieldset" >
				<legend class="demo_legend"  >#{msg.label_input_server}</legend>
				<div>
				<h:panelGrid columns="4" columnClasses ="colStyle1,colStyle2,colStyle4,colStyle5" width="100%">			
					<h:outputText value="#{msg.label_name}" styleClass="labelForm" />
					<h:inputText id="input_name_service" value="#{wEmailAccountBean.currEmailAccount.inputServerName}"
						required="false"  style="width:180px"/>
						
					<rich:spacer height="10" />
					<rich:spacer height="10" />	
				
					<h:outputText value="#{msg.label_port}" styleClass="labelForm" />
					<h:inputText id="input_port" value="#{wEmailAccountBean.currEmailAccount.inputPort}"
						required="false"  style="width:50px"/>
						
					<h:outputText value="#{msg.label_type}" styleClass="labelForm" />
					<h:inputText id="input_server_type" value="#{wEmailAccountBean.currEmailAccount.inputServerType}"
						required="false"  style="width:50px"/>		
						
					<h:outputText value="#{msg.label_connection_security}" styleClass="labelForm" />
					<h:inputText id="input_security" value="#{wEmailAccountBean.currEmailAccount.connectionSecurity}"
							required="false"  style="width:150px"/>	
						
					<h:outputText value="#{msg.label_identification_method}" styleClass="labelForm" />
					<h:inputText id="input_ident_method" value="#{wEmailAccountBean.currEmailAccount.identificationMethod}"
						required="false"  style="width:150px"/>			
		
				</h:panelGrid>
				</div>
			</fieldset>	
			
			<rich:spacer width="10" />
			
			<fieldset id="salida" class="demo_fieldset" >	 
				<legend class="demo_legend">#{msg.label_output_server}</legend>
				<div>
					<h:panelGrid columns="4" columnClasses ="colStyle1,colStyle2,colStyle4,colStyle5" width="100%">
						
					<h:outputText value="#{msg.label_name}" styleClass="labelForm" />
					<h:inputText id="output_server_name" value="#{wEmailAccountBean.currEmailAccount.outputServer}"
						required="false"  style="width:180px"/>
						
					<rich:spacer height="10" />	
					<rich:spacer height="10" />		
						
					<h:outputText value="#{msg.label_port}" styleClass="labelForm" />
					<h:inputText id="output_port" value="#{wEmailAccountBean.currEmailAccount.outputPort}"
						required="false"  style="width:50px"/>
						
					<rich:spacer height="10" />	
					<rich:spacer height="10" />		
				
					<h:outputText value="#{msg.label_connection_security}" styleClass="labelForm" />
						
					<h:selectOneMenu id="seguridadSal" value="#{wEmailAccountBean.currEmailAccount.outputConnectionSecurity}" style="width:150px">
						<f:selectItems value="#{wEmailAccountBean.securityList}" />
					</h:selectOneMenu>	
											
					<h:outputText value="#{msg.label_identification_method}" styleClass="labelForm" />
					<h:inputText id="id_method" value="#{wEmailAccountBean.currEmailAccount.identificationMethod}"
						required="false"  style="width:150px"/>		
													
					<h:outputText value="#{msg.label_usuario}" styleClass="labelForm" />
					<h:inputText id="output_user" value="#{wEmailAccountBean.currEmailAccount.outputUserName}"
						required="false"  style="width:150px"/>
						
					<h:outputText value="#{msg.label_output_password}" styleClass="labelForm" />
					<h:panelGroup id="output_password_panel">
						<h:inputSecret id="output_password" value="#{wEmailAccountBean.currEmailAccount.outputPassword}"
							readonly="#{wEmailAccountBean.outputPasswordEditable?'false':'true'}"
							required="false" style="width:150px">
		            		<a4j:support event="onchange" ajaxSingle="true" action="#{wEmailAccountBean.changeOutputPassword}"/>
						</h:inputSecret>
						<a4j:commandButton id="changePasswordButton" value="#{msg.label_new_password}"
							rendered="#{!wEmailAccountBean.outputPasswordEditable}"
							oncomplete="onsubmitChangePasswordButton();"
							style="margin-left: 10px;"/>			
					</h:panelGroup>
				
				</h:panelGrid>	
				</div>
			</fieldset>
		</h:panelGrid>

		<rich:spacer height="10" />

		<rich:panel style="width:98%">
			<rich:dataTable id="w_user_email_accounts_table" width="70%" 
				onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
				onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
								
				rows="5" styleClass="table" 
				value="#{wEmailAccountBean.emailAccountListByUser}" var="wuea" >
				
				 <a4j:support event="onRowClick" reRender="w_user_email_account_form" action="#{wEmailAccountBean.loadCurrentWEmailAccount}">
                	<a4j:actionparam name="value" value="#{wuea.id}" assignTo="#{wEmailAccountBean.id}"/>
                </a4j:support>	
				
				<f:facet name="header">
					<h:outputText value="#{msg.label_user_email_accounts}" />
				</f:facet>

	           	<rich:column  style="width:5%; text-align: left;"> 
	                <f:facet name="header">
	                    <h:outputText value="#{msg.label_id}"/>
	                </f:facet>
	                <h:outputText value="#{wuea.id}"/>
	            </rich:column> 
	            
	            <rich:column  style="width:15%; text-align: left;"> 
	                <f:facet name="header">
	                    <h:outputText value="#{msg.label_is_default_account}"/>
	                </f:facet>
	                <h:outputText value="#{wuea.userDefaultAccount ? msg.label_yes : msg.label_no}"/>
	            </rich:column> 
	            
	           	<rich:column  style="width:40%; text-align: left;"> 
	                <f:facet name="header">
	                    <h:outputText value="#{msg.label_name}"/>
	                </f:facet>
	                <h:outputText value="#{wuea.name}"/>
	            </rich:column>
	            	             
	            <rich:column  style="width:40%; text-align: left;"> 
	                <f:facet name="header">
	                    <h:outputText value="#{msg.label_email}"/>
	                </f:facet>
	                <h:outputText value="#{wuea.email}"/>
	            </rich:column>  
			</rich:dataTable>
			
			<rich:spacer height="10" />
			
			<rich:datascroller for="w_user_email_accounts_table" maxPages="10"  
				reRender="w_user_email_account_form"/>
		
			<rich:spacer height="10" />
			
			<h:inputHidden id="sessionId" value="#{wEmailAccountBean.currentSession}"/>
		
		</rich:panel>
	</h:form>
	</rich:panel> 
	</center>

<script type="text/javascript">
	
	document.getElementById("w_user_email_account_form:deleteButton").disabled = true;
	//document.getElementById("w_user_email_account_form:saveButton").disabled = true;
	//var currentSession = document.getElementById("frmUceLista:sessionId").value;
	
	//urlForAction = "/fgp_piloto/mantenimientos/uceCrud.jsf;jsessionid=" + currentSession;
</script>	

</ui:composition>


